# トランスフォーマー + ViT を使用したリアルタイム株価予測システム

## 概要
このプロジェクトは、HYPER SBI 2 のチャートを利用したリアルタイム株価予測システムです。時系列データにはトランスフォーマーモデルを、画像解析には Vision Transformer (ViT) を活用し、リアルタイムで株価の上昇・下降を予測します。

## 特徴
- **リアルタイムチャート監視:** HYPER SBI 2 のチャート画面をスクリーンショットなしで継続監視。
- **マルチモーダル分析:** 時系列データ（OHLCV）とチャート画像の特徴を統合。
- **深層学習モデル:** 時系列データにトランスフォーマー、チャート画像に ViT を使用。
- **高精度予測:** 2 つのデータソースを統合し、より正確な予測を実現。

## システムアーキテクチャ
```
+------------------+      +------------------+      +------------------+
| 時系列データ      | ---> | Transformer(時系列分析モデル) | ---> | 最終判断          |
+------------------+      +------------------+      +------------------+
                           |
                           |      +------------------+
                           | ---> | ViT (画像認識モデル)  |
                                  +------------------+
```

## コンポーネント

### 1. データ取得
- **リアルタイムチャート監視:**
  - OpenCV を使用して HYPER SBI 2 の画面を継続キャプチャ。
  - 3 分足のローソク足チャートと一目均衡表を監視。

### 2. データ処理
- **Vision Transformer (ViT):**
  - チャート画像（ローソク足、一目均衡表など）から特徴を抽出。
- **トランスフォーマー (時系列分析):**
  - 過去の OHLCV データを分析し、トレンドを予測。

### 3. 予測モデル
- **統合分析:**
  - ViT とトランスフォーマーの特徴量を統合。
  - リアルタイムで「上昇 or 下降」の確率を出力。

## ワークフロー
1. **リアルタイム監視:** OpenCV を使用してライブチャートを取得。
2. **特徴抽出:**
   - ViT で画像の特徴（チャートパターン）を抽出。
   - トランスフォーマーで時系列データ（価格推移）を分析。
3. **予測:**
   - マルチモーダルモデルが両方の特徴を統合。
   - 株価の上昇・下降の確率を出力。

## 必要環境
- **Python 3.x**
- **ライブラリ:**
  - `numpy`, `pandas`, `opencv-python`
  - `torch`, `transformers`, `tensorflow`

## インストール
```bash
pip install numpy pandas opencv-python torch transformers tensorflow
```

## 使い方
1. **HYPER SBI 2 のセットアップ:**
   - チャート画面を開き、監視用に設定。
2. **リアルタイム監視の実行:**
   - システムを起動し、ライブチャート取得と予測を開始。

## 今後の課題
- **モデルの最適化:**
  - 異なるトランスフォーマーや ViT のアーキテクチャを試す。
- **パフォーマンス向上:**
  - GPU を活用し、推論速度を高速化。

## ライセンス
.LICENSEに記載の通り

